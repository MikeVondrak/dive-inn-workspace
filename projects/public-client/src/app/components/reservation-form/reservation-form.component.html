<div #Top></div>
<div [@fadeScaletransitionsParent]="(formState$ | async)" (@fadeScaletransitionsParent.done)="animationDone($event)" [ngSwitch]="(formState$ | async)" class="reservation-form-container">
  <div class="active" *ngSwitchCase="reservationFormState.ENTRY"><ng-container *ngTemplateOutlet="Form"></ng-container></div>
  <div class="active" *ngSwitchCase="reservationFormState.SUBMITING"><ng-container *ngTemplateOutlet="Loading"></ng-container></div>
  <div class="active" *ngSwitchCase="reservationFormState.SUCCESS"><ng-container *ngTemplateOutlet="Success"></ng-container></div>
  <div class="active" *ngSwitchCase="reservationFormState.ERROR"><ng-container *ngTemplateOutlet="Error"></ng-container></div>
  <!-- <div *ngSwitchDefault>DEFAULT</div> -->
</div>

<ng-template #Form>
  <form [formGroup]="emailForm" #ngForm="ngForm" (ngSubmit)="sendEmail()">
      
    <div class="label-column label-organizer required">
      <label for="organizer" class="nowrap">Organizer<span>*</span></label>
    </div>
    <div class="input-organizer">
      <input type="text" id="organizer" [ngClass]="hasErrors(formGet('organizer')) ? 'has-error' : ''" formControlName="organizer">
    </div>
        
    <div class="label-column label-phone required">
      <label for="phone" class="nowrap">Phone<span>*</span></label>
    </div>
    <div class="input-phone">
      <input type="text" id="phone" [ngClass]="hasErrors(formGet('phone')) ? 'has-error' : ''" formControlName="phone">
    </div>
    
    <div class="label-column label-email required">
      <label for="email" class="nowrap">Email<span>*</span></label>
    </div>
    <div class="input-email">
      <input type="text" id="email" [ngClass]="hasErrors(formGet('email')) ? 'has-error' : ''" formControlName="email">
    </div>
    
    <div class="label-column label-contact required">
      <label class="nowrap">Preferred<span>*</span></label>
    </div>
    <div class="input-contact-email">
      <input type="radio" id="preferred-contact-email" [value]="contactType.EMAIL" formControlName="contactMethod">
      <label for="preferred-contact-email">Email</label>
    </div>
    <div class="input-contact-voice">
      <input type="radio" id="preferred-contact-voice" [value]="contactType.VOICE" formControlName="contactMethod">
      <label for="preferred-contact-voice">Voice</label>
    </div>
    <div class="input-contact-text">
      <input type="radio" id="preferred-contact-text" [value]="contactType.TEXT" formControlName="contactMethod">
      <label for="preferred-contact-text">Text</label>
    </div>

    <div class="label-column label-date required">
      <label for="date" class="nowrap">Date<span>*</span></label>
    </div>
    <div class="input-date">
      <input type="date" id="date" [ngClass]="hasErrors(formGet('partyDate')) ? 'has-error' : ''" formControlName="partyDate">
    </div>
    
    <div class="label-column label-start-time required">
      <label for="start-time" class="nowrap">Start<span>*</span></label>
    </div>
    <div class="input-start-time">
      <input type="time" id="start-time" [ngClass]="hasErrors(formGet('startTime')) ? 'has-error' : ''" formControlName="startTime">
    </div>
    <div class="label-column label-end-time required">
      <label for="end-time">End</label>
    </div>
    <div class="input-end-time">
      <input type="time" id="end-time" formControlName="endTime">
    </div>

    <div class="label-column label-theme">
      <label for="party-theme">Theme</label>
    </div>
    <div class="input-theme">
      <input type="text" id="party-theme" formControlName="partyTheme">
      <!-- <label>(Example: A-1 Scuba Holiday Party or Jacques Is Diving Into “50”)</label> -->
    </div>
    
    <div class="label-column label-birthday">
      <label for="birthday" class="birthday">Birthday</label>
    </div>
    <div class="input-birthday">
      <input type="checkbox" id="birthday" formControlName="birthday">
    </div>
    <div class="label-column label-age">
      <label for="birthday-age">Age</label>    
    </div>
    <div class="input-age">
      <input type="text" id="birthday-age" formControlName="birthdayAge">
    </div>
    
    <div class="label-column label-birthday-name">
      <label for="birthday-name">Name</label>
    </div>
    <div class="input-birthday-name">
      <input type="text" id="birthday-name" formControlName="birthdayName">
    </div>

    <div class="label-column label-headcount required">
      <label for="headcount" class="nowrap">Headcount<span>*</span></label>
    </div>
    <div class="input-headcount">
      <input type="number" id="headcount" min="1" [ngClass]="hasErrors(formGet('headcount')) ? 'has-error' : ''" formControlName="headcount">
    </div>

    <div class="checkboxes label-column label-preferred-space">
      <label>Preferred Space</label>
    </div>
    <div class="preferred-space-1">
      <input type="checkbox" id="space-main-room" formControlName="preferredSpaceMainRoom">
      <label for="space-main-room"><span>1.</span> The Oasis <span>(18-24)</span></label>
      <img class="sun-icon" src="/assets/images/sun_icon.svg" title="Outdoors" alt="Outdoors" />
    </div>
    <div class="preferred-space-2">
      <input type="checkbox" id="space-party-boat" formControlName="preferredSpacePartyBoat">
      <label for="space-party-boat"><span>2.</span> The Boat <span>(1-13)</span></label>
    </div>
    <div class="preferred-space-3">
      <input type="checkbox" id="space-north-patio" formControlName="preferredSpaceNorthPatio">
      <label for="space-north-patio"><span>3.</span> The Galley <span>(50-60)</span></label>
    </div>
    <div class="preferred-space-4">
      <input type="checkbox" id="space-north-room" formControlName="preferredSpaceNorthRoom">
      <label for="space-north-room"><span>4.</span> The Cabin <span>(40-50)</span></label>
    </div>
    <div class="preferred-space-5">
      <input type="checkbox" id="space-game-room" formControlName="preferredSpaceGameRoom">
      <label for="space-south-room"><span>5.</span> The Deck <span>(80-100)</span></label>
      <img class="sun-icon" src="/assets/images/sun_icon.svg" title="Outdoors" alt="Outdoors" />
    </div>
    <div class="preferred-space-6">
      <input type="checkbox" id="space-south-room" formControlName="preferredSpaceSouthRoom">
      <label for="space-south-room"><span>6.</span> The Saloon <span>(40-70)</span></label>
    </div>
    <div class="preferred-space-7">
      <input type="checkbox" id="space-south-patio" formControlName="preferredSpaceSouthPatio">
      <label for="space-south-patio"><span>7.</span> The Cabana <span>(10-250)</span></label>
      <img class="sun-icon" src="/assets/images/sun_icon.svg" title="Outdoors" alt="Outdoors" />
    </div>
    <div class="preferred-space-8">
      <input type="checkbox" id="space-none" formControlName="preferredSpaceNone">
      <label for="space-none"><span>-. </span>No Preference</label>
    </div>
    
    <div class="label-column label-notes">
      <label for="comments">Notes</label>
    </div>
    <div class="input-notes">
      <textarea type="text" id="comments" class="" style="resize: none" formControlName="comments"></textarea>
    </div>

    <div class="input-submit">
      <button type="submit" (click)="clickEmpty($event)">Submit</button>
      <small *ngIf="ngForm.submitted && ngForm.invalid" class="form-errors">Please correct<br>errors above</small>
    </div>
  </form>
</ng-template>

<ng-template #Loading>
  <div class="status-card">
    <div class="status-message">
      <h2>Submitting</h2>
      <p>Please wait...</p>
    </div>
  </div>
</ng-template>

<ng-template #Success>
  <div class="status-card">
    <div class="status-message">
      <h2>Reservation Submitted</h2>
      <p>You should receive a confirmation email shortly.</p>
      <button (click)="errorCancelClick()">Return to Form</button>
      <p>If you do not receive an email within an hour, please call to confirm your reservation details:<br/><a href="tel:7202426157">720-242-6157</a></p>
    </div>
  </div>
</ng-template>

<ng-template #Error>
  <div class="status-card">
    <div class="status-message error">
      <h2>Error Submitting Request!</h2>
      <p>Something went wrong submitting your reservation, and we may not have received your request.</p>
      <!-- <div class="split-text">
        <p>Click Cancel to edit your reservation</p>
        <p>Click Retry to send it again</p>
      </div> -->
      <div class="buttons">
        <button (click)="errorCancelClick()">Edit Reservation</button>
        <button (click)="sendEmail()">Resend Request</button>
      </div>
      <p>If you are still unable to send your reservation, please call us at: <br><a href="tel:7202426157">720-242-6157</a></p>
    </div>
  </div>
</ng-template>